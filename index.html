<!DOCTYPE html>
<html lang="en">

<head>
  <!--meta content and open graph tags for social sharing see _includes/metal.html-->
  <title>Town of Forest City Web Viewer</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <!-- <link href='//fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400italic,400,800,700|Archivo+Narrow:400,700|Archivo+Black' rel='stylesheet' type='text/css'>-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js" integrity="sha256-wS9gmOZBqsqWxgIVgA8Y9WcQOa7PgSIX+rPA0VL2rbQ="
    crossorigin="anonymous"></script>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <link href="css/leaflet-panel-layers.min.css" rel="stylesheet">

  <!-- <script src="https://maps.google.com/maps/api/js?v=3"></script> -->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" href="https://unpkg.com/leaflet@0.7.7/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@0.7.7/dist/leaflet.js"></script>

  <!-- <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script> -->

  <link rel="stylesheet" href="css/custom-leaflet-0.7.css" />
  <link rel="stylesheet" href="css/leaflet-measure.css" />

  <script src="js/custom-leaflet-0.7.js"></script>
  <script src="js/leaflet-panel-layers.js"></script>
  <script src="js/leaflet-measure.min.js"></script>

  <link rel="stylesheet" href="css/custom-ui.css" />

  <style>
    * {
      font-family: "Open Sans", sans-serif;
    }
    hr {
      margin-top: 10px;
      margin-bottom: 10px;
    }

  </style>

</head>

<body>
  <script src="js/geojson-vt.js"></script>
  <script src="js/L.CanvasTiles.js"></script>
  <script src="data/parcels.json"></script>
  <script src="data/town.geojson"></script>
  <script src="data/zoning.geojson"></script>
  <!-- <script src="data/floodplains.geojson"></script>
  <script src="data/wetlands.geojson"></script>
  <script src="data/buildingfootprints2007.geojson"></script>
  <script src="data/addresspoints.geojson"></script>
  <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-pip/v0.1.0/leaflet-pip.min.js'></script> -->
  <div id='map'>
    <div id="sidebar">
      <h2 style="font-family:Archivo Black, sans-serif;">Town of Forest City</h2>
      <h3 style="font-family:Archivo Black, sans-serif;">Rutherford County, N.C.</h3>
      <h5 style="font-family:Archivo Black, sans-serif;">
      Address: 128 N Powell St. Forest City, N.C.<br>
      Phone: 828-247-4412<br>
      Fax: 570-319-1321<br>
      Hours: 8:00 A.M. â€“ 5:00 P.M., Monday through Friday<br>
      E-mail Address: drewharris@townofforestcity.com</span></h5>
      <hr />
      <strong>Use zoom controls to navigate the map. Pinch & zoom and double tap to zoom have been disabled.</strong>
      <hr />
      <em>The parcels shown are for informational purposes only. <br>Map data is only updated once or so per year.</em>

      <div>
        <hr />
        <button id="showTools" type="button" class="btn btn-default btn-xs btn-block">Show Map Tools Legend</button>
        <button id="hideTools" type="button" class="btn btn-default btn-xs btn-block" style="display:none;">Hide Map Tools Legend</button>
        <div class="toolLegend" style="display:none;">
          <hr />
          <div class="list-group" style="text-align:left;">
            <li class="list-group-item">
              <i class='fa fa-bars fa-fw fa-lg'></i> Open Sidebar</li>

            <li class="list-group-item">
              <i class='fa fa-exchange fa-fw fa-lg'></i> Toggle Address Search</li>

            <li class="list-group-item">
              <img src="images/fullscreen-img.png" style="padding:0 1px;width:22px;"></img> Fullscreen</li>
            <li class="list-group-item">
              <i class='fa fa-globe fa-fw fa-lg'></i> Default Map Extent</li>
            <li class="list-group-item">
              <i class='fa fa-map-marker fa-fw fa-lg'></i> Show/Follow Your Location</li>

            <li class="list-group-item">
              <i class='fa fa-cogs fa-fw fa-lg'></i> Toggle Map Tools (Mobile Only)</li>
            <li class="list-group-item">
              <img src="images/layers-bl.png" style="padding:0 1px;width:22px;"></img> Toggle Map Layers</li>

          </div>
        </div>
        <hr />
      </div>
      <script>
      // toggle toolbar visible/invisible
        $("#showTools").click(function () {
          $(".toolLegend").toggle();
          $("#showTools").toggle();
          $("#hideTools").toggle();
        });
        $("#hideTools").click(function () {
          $(".toolLegend").toggle();
          $("#showTools").toggle();
          $("#hideTools").toggle();
        });
      </script>

      <h6><a href='http://townofforestcity.com' target='_blank' style='text-decoration:none;'>Town of Forest City</a> | Map data updated 6/2019.</h6>

    </div>
  </div>
  <script>
    var tileLayer;
    var zoning, floodplains;

    var map = L.map('map', {
      zoomControl: false,
      minZoom: 10,
      touchZoom: false,
      zoomAnimationThreshold: 2,
      doubleClickZoom: false
    }).setView([35.333687, -81.864660], 12);

	var measureControl = L.control.measure({position: 'bottomright'});
	measureControl.addTo(map);

  //remove existing attribution control by hiding it only on mobile
  //make sure the normal control is hidden
  var style = document.createElement('style');
  style.type = 'text/css';
  style.innerHTML = '.leaflet-control-attribution {display: none;};@media screen and (max-width:768px) {.elevation.leaflet-control {display:none}}';
  document.getElementsByTagName('head')[0].appendChild(style);

  if (L.Browser.mobile) {

    var toggleAttribution = L.Control.extend({
      options: { position: 'bottomright' },
      onAdd: function (map) {
        this._div = L.DomUtil.create('button', 'btn btn-link');
        this._div.innerHTML = "Leaflet | Map Tiles";
        L.DomEvent.on(this._div, 'click', this._click);
        return this._div;
      },

      _click: function (e) {
        L.DomEvent.stop(e);
        x = document.getElementsByClassName("leaflet-control-attribution")[0];
        x.style.display = x.style.display === 'block' ? '' : 'block';
      },

    });
    map.addControl(new toggleAttribution());
  } else {
    x = document.getElementsByClassName("leaflet-control-attribution")[0];
    x.style.display = x.style.display === 'block' ? '' : 'block';
  }

// begin with map tiles //

var theScale = L.control.scale({ metric: false, imperial: true }).addTo(map);

var osm = L.tileLayer('//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxNativeZoom: 19,
  maxZoom: 22,
  attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
});

var osmhot = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href="http://hot.openstreetmap.org/" target="_blank">Humanitarian OpenStreetMap Team</a>'
});

var stamentoner = new L.tileLayer.provider('Stamen.Toner');
var stamentonerlight = new L.tileLayer.provider('Stamen.TonerLite');
var watercolor = L.tileLayer('//stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png', {
  attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
  subdomains: 'abcd',
  maxNativeZoom: 14,
  maxZoom: 17,
  ext: 'png',
});
var esrigray = L.tileLayer('//server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}', {
  attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',
  maxNativeZoom: 16,
  maxZoom: 19,
});
var esritopo = L.tileLayer('//server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}', {
  attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community',
  maxZoom: 22,
  maxNativeZoom: 18,
});

// container for base layers
var baseLayers = [
  {
    active: true,
    name: "Open Street Map",
    layer: L.tileLayer('//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')
  },
  {
    active: false,
    name: "Satellite",
    layer: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}')
  },
  {
    active: false,
    name: "Topography",
    layer: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}')
  }
];

// layer styling //

var muniStyle = {
  "color": "#000",
  "weight": 2,
  "opacity": 1,
  fillOpacity: 0
};
var floodplainStyle = {
  "color": "#178eef",
  "weight": 2,
  "opacity": 0.65,
  fillOpacity: 0.5,
  fillColor: '#abd3f4'
};
var wetlandsStyle = {
  "color": "#78808c",
  "weight": 1,
  "opacity": 0.65,
  fillOpacity: 0.5,
  fillColor: '#adafb2',
  fillRule: 'evenodd'
};
var addressptsStyle = {
  "color": "#37c132",
  "weight": 1,
  "opacity": 0.65
};
var buildingsStyle = {
  "color": "#c17e32",
  "weight": 1,
  "opacity": 0.65,
  fillOpacity: 0.5,
  fillColor: '#f4c997'
};
var overLayers = [
  {
    active: false,
    name: "Zoning",
    layer: L.geoJson(zoning, {
      style: function(feature) {
        return {
          weight: 2,
          opacity: 1,
          color: 'white',
          dashArray: '3',
          fillOpacity: getZoneOpacity(feature.properties.ZONE),
          fillColor: getZoneColor(feature.properties.ZONE)
        };
        }
      , onEachFeature: onEachZoningFeature})
  }
  ,{
    active: false,
    name: "Floodplains",
    layer: L.geoJson(floodplains, {style: floodplainStyle})
  }
  ,{
    active: false,
    name: "Municipal Boundary",
    layer: L.geoJson(muni, {style: muniStyle})
  }
  ,{
    active: false,
    name: "Wetlands",
    layer: L.geoJson(wetlands, {style: wetlandsStyle})
  }
  // ,{
  // 	active: false,
  // 	name: "911 Address Points",
  // 	icon: '<i class="icon icon-parking"></i>',
  // 	layer: L.geoJson(addresspts, {style: addressptsStyle, onEachFeature: onEachAddressFeature})
  // }
  ,{
    active: false,
    name: "Buildings",
    layer: L.geoJson(buildings, {style: buildingsStyle})
  }
];

</script>
</body>
</html>
